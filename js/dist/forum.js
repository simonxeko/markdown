module.exports=function(t){var e={};function n(i){if(e[i])return e[i].exports;var r=e[i]={i:i,l:!1,exports:{}};return t[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)n.d(i,r,function(e){return t[e]}.bind(null,r));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=6)}([function(t,e){t.exports=flarum.core.compat.extend},function(t,e){t.exports=flarum.core.compat["components/TextEditor"]},function(t,e){t.exports=flarum.core.compat.Component},function(t,e,n){var i,r,l;"undefined"!=typeof self&&self,r=[],void 0===(l="function"==typeof(i=function(){var t=/mac|iphone|ipad|ipod/i.test(navigator.platform)?"metaKey":"ctrlKey",e=/^["'`*_[({<>})\]]$/,n=/[*_]/,i=/^[ \t]*(?:(?:[-+*]|\d+\.)[ \t]+(?:\[[ x]][ \t]+)?|>[ \t]*)*(?::[ \t]*)?/,r=/(?:[-+*]|\d+\.)[ \t]+(?:\[[ x]][ \t]+)?$/,l=/[-+*\[\]x\d.]/g,o=/[^ \t]/g,s=/(\d+)\.(?=[ \t]+$)/,a=/(?:(?:^[ \t]+)?(?:[-+*]|\d+\.|[>:])(?:[ \t]+\[[ x]])?[ \t]*|^[ \t]+)$/,c=/^(?!$)/gm,u={"`":/^``$/m,"~":/^~~$/m},f={"[":"]","(":")","{":"}","<":">"},h={"]":"[",")":"(","}":"{",">":"<"};function d(t){console.log("Create MarkdownArea"),this._useTab=!0,this._useInline=!0,this._indent="    ",this._reOutdent=/^[ ]{4}/gm,this._reKey=p(!0,!0),this._handleKey=this._handleKey.bind(this),this.setElement(t)}function p(t,e){return new RegExp("^(?:Enter"+(t?"|Tab":"")+"|[io"+(e?"\"'`*_([{<>}\\])":"")+"])$")}function g(t,e,n,i){if(t.value=e,t.selectionStart=n,t.selectionEnd=arguments.length>3?i:n,"InputEvent"in window)try{var r=new InputEvent("input");t.dispatchEvent(r)}catch(i){}}return d.prototype={constructor:d,getElement:function(){return this._elem},setElement:function(t){this._elem&&this._elem.removeEventListener("keyup",this._handleKey),this._elem=t,t.addEventListener("keyup",this._handleKey)},getValue:function(){return this._elem.value},setValue:function(t){this._elem.value=t},getIndent:function(){return this._indent},setIndent:function(t){this._indent="number"==typeof t?new Array(t+1).join(" "):(t+"").replace(/[^ \t]/g," "),this._reOutdent=new RegExp("^"+this._indent,"mg")},isTabUsed:function(){return this._useTab},useTab:function(){this._useTab=!0,this._reKey=p(!0,this._useInline)},ignoreTab:function(){this._useTab=!1,this._reKey=p(!1,this._useInline)},isInlineEnabled:function(){return this._useInline},enableInline:function(){this._useInline=!0,this._reKey=p(this._useTab,!0)},disableInline:function(){this._useInline=!1,this._reKey=p(this._useTab,!1)},destroy:function(){this._elem.removeEventListener("keyup",this._handleKey),this._elem=this._reKey=this._handleKey=this._indent=this._reOutdent=null},_handleKey:function(d){if(!d.defaultPrevented&&this._reKey.test(d.key)){var p=d.target.value.substring(0,d.target.selectionStart),m=d.target.value.substring(d.target.selectionStart,d.target.selectionEnd),v=d.target.value.substring(d.target.selectionEnd);if("Enter"!==d.key||d.ctrlKey||d.altKey||d.metaKey)if("Tab"===d.key&&!d.shiftKey||"i"===d.key&&d[t])!function(t,e,n,i,r){var l=e.length,o=e.lastIndexOf("\n")+1;o<l&&(n=e.substring(o)+n,e=e.substring(0,o)),(o<l||!n)&&(l+=r.length),n?n=n.replace(c,r):e+=r,g(t,e+n+i,l,n?o+n.length:l)}(this._elem,p,m,v,this._indent);else if("Tab"===d.key&&d.shiftKey||"o"===d.key&&d[t])!function(t,e,n,i,r,l){var o=e.length,s=e.lastIndexOf("\n")+1;s<o&&(n=e.substring(s)+n,e=e.substring(0,s),n.substring(0,r.length)===r&&(o-=r.length)),n=n.replace(l,""),g(t,e+n+i,o,s+n.length)}(this._elem,p,m,v,this._indent,this._reOutdent);else{if(!e.test(d.key))return;!function(t,e,i,r,l){i||l in f||r.charAt(0)!==l?!i&&("'"===l||l in h)?g(t,e+l+r,e.length+1):!i&&l in u&&u[l].test(e)?g(t,e+l+"language\n"+l+l+l+("\n"!==r.charAt(0)?"\n":"")+r,e.length+1,e.length+9):g(t,e+(h[l]||l)+i+(f[l]||l)+r,e.length+1,e.length+1+i.length):g(t,e+(n.test(l)?l+l:"")+r,e.length+1)}(this._elem,p,m,v,d.key)}else!function(t,e,n,c,u){if(!(e.length>0&&"\n"!=e.charAt(e.length-1))){e=e.substring(0,e.length-1);var f,h,d,p,m=n?null:(h=(f=e).lastIndexOf("\n")+1,d=f.substring(h),p=i.exec(d),{line:d,offset:h,prefix:p&&p[0]});!n&&m.prefix?u||m.prefix!==m.line?!u&&function(t){return r.test(t)}(m.prefix)?e+="\n"+function(t){return t.replace(s,function(t,e){return parseInt(e)+1+"."})}(m.prefix):e+="\n"+function(t,e){return t.replace(e?o:l," ")}(m.prefix,u):e=e.substring(0,m.offset)+function(t){return t.replace(a,"")}(m.prefix):e+="\n",g(t,e+c,e.length)}}(this._elem,p,m,v,d.shiftKey);d.preventDefault()}}},d})?i.apply(e,r):i)||(t.exports=l)},function(t,e){t.exports=flarum.core.compat["helpers/icon"]},function(t,e){
/*! https://mths.be/startswith v0.2.0 by @mathias */
String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(t,e){return e=!e||e<0?0:+e,this.substring(e,e+t.length)===t}}),String.prototype.endsWith||(String.prototype.endsWith=function(t,e){return(void 0===e||e>this.length)&&(e=this.length),this.substring(e-t.length,e)===t})},function(t,e,n){"use strict";n.r(e);var i=n(0),r=n(1),l=n.n(r),o=n(3),s=n.n(o);n(5);function a(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var c=n(2),u=n.n(c),f=navigator.userAgent.match(/Macintosh/)?"Meta":"Control",h=function(t){function e(){return t.apply(this,arguments)||this}a(e,t);var n=e.prototype;return n.config=function(t){t||document.getElementById(this.props.for).addEventListener("keydown",this.shortcut.bind(this))},n.view=function(){return m("div",{id:"MarkdownToolbar","data-for":this.props.for,style:{display:"inline-block"}},this.props.children)},n.shortcut=function(t){if(t.metaKey&&"Meta"===f||t.ctrlKey&&"Control"===f){var e=this.element.querySelector('[data-hotkey="'+t.key+'"]');e&&(e.click(),t.preventDefault())}},e}(u.a),d=n(4),p=n.n(d);function g(){return(g=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}var v=null;function y(t){return t.trim().split("\n").length>1}function x(t,e){return Array(e+1).join(t)}function b(t,e,n){for(var i=e,r=n?/\n/:/\s/;t[i]&&!t[i].match(r);)i++;return i}function _(t){var e,n,i=t.value.slice(0,t.selectionStart),r=t.value.slice(t.selectionEnd),l=i.match(/\n*$/),o=r.match(/^\n*/),s=l?l[0].length:0,a=o?o[0].length:0;return i.match(/\S/)&&s<2&&(e=x("\n",2-s)),r.match(/\S/)&&a<2&&(n=x("\n",2-a)),null==e&&(e=""),null==n&&(n=""),{newlinesToAppend:e,newlinesToPrepend:n}}var E=function(t,e){var n=e.prefix,i=e.suffix,r=e.blockPrefix,l=e.blockSuffix,o=e.replaceNext,s=e.prefixSpace,a=e.scanFor,c=e.surroundWithNewlines,u=t.selectionStart,f=t.selectionEnd,h=t.value.slice(t.selectionStart,t.selectionEnd),d=y(h)&&r.length>0?r+"\n":n,p=y(h)&&l.length>0?"\n"+l:i;if(s){var g=t.value[t.selectionStart-1];0===t.selectionStart||null==g||g.match(/\s/)||(d=" "+d)}h=function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(t.selectionStart===t.selectionEnd)t.selectionStart=function(t,e){for(var n=e;t[n]&&null!=t[n-1]&&!t[n-1].match(/\s/);)n--;return n}(t.value,t.selectionStart),t.selectionEnd=b(t.value,t.selectionEnd,i);else{var r=t.selectionStart-e.length,l=t.selectionEnd+n.length,o=t.value.slice(r,t.selectionStart)===e,s=t.value.slice(t.selectionEnd,l)===n;o&&s&&(t.selectionStart=r,t.selectionEnd=l)}return t.value.slice(t.selectionStart,t.selectionEnd)}(t,d,p,e.multiline);var m=t.selectionStart,v=t.selectionEnd,x=o.length>0&&p.indexOf(o)>-1&&h.length>0;if(c){var E=_(t);d=E.newlinesToAppend+n,p+=E.newlinesToPrepend}if(h.startsWith(d)&&h.endsWith(p)){var S=h.slice(d.length,h.length-p.length);if(u===f){var k=u-d.length;k=Math.max(k,m),m=v=k=Math.min(k,m+S.length)}else v=m+S.length;return{text:S,selectionStart:m,selectionEnd:v}}if(x)return a.length>0&&h.match(a)?{text:d+(p=p.replace(o,h)),selectionStart:m=v=m+d.length,selectionEnd:v}:{text:d+h+p,selectionStart:m=m+d.length+h.length+p.indexOf(o),selectionEnd:v=m+o.length};var w=d+h+p;m=u+d.length,v=f+d.length;var T=h.match(/^\s*|\s*$/g);if(e.trimFirst&&T){var O=T[0]||"",I=T[1]||"";w=O+d+h.trim()+p+I,m+=O.length,v-=I.length}return{text:w,selectionStart:m,selectionEnd:v}},S=function(t,e){var n,i=t.value.slice(t.selectionStart,t.selectionEnd);n=e.orderedList?function(t){var e,n,i,r,l=/^\d+\.\s+/,o=t.selectionStart===t.selectionEnd,s=t.value.slice(t.selectionStart,t.selectionEnd),a=s,c=s.split("\n");if(o){var u=t.value.slice(0,t.selectionStart).split(/\n/);i=t.selectionStart-u[u.length-1].length,r=b(t.value,t.selectionStart,!0),a=t.value.slice(i,r)}var f=a.split("\n");if(f.every(function(t){return l.test(t)})){if(s=(c=f.map(function(t){return t.replace(l,"")})).join("\n"),o&&i&&r){var h=f[0].length-c[0].length;n=e=t.selectionStart-h,t.selectionStart=i,t.selectionEnd=r}}else{s=(c=function(){var t,e,n,i=[];for(n=t=0,e=c.length;t<e;n=++t){var r=c[n];i.push(n+1+". "+r)}return i}()).join("\n");var d=_(t),p=d.newlinesToAppend,g=d.newlinesToPrepend;e=(n=t.selectionStart+p.length)+s.length,o&&(n=e),s=p+s+g}return{text:s,selectionStart:n,selectionEnd:e}}(t):e.multiline&&y(i)?function(t,e){var n=e.prefix,i=e.suffix,r=e.surroundWithNewlines,l=t.value.slice(t.selectionStart,t.selectionEnd),o=t.selectionStart,s=t.selectionEnd,a=l.split("\n");if(a.every(function(t){return t.startsWith(n)&&t.endsWith(i)}))s=o+(l=a.map(function(t){return t.slice(n.length,t.length-i.length)}).join("\n")).length;else if(l=a.map(function(t){return n+t+i}).join("\n"),r){var c=_(t),u=c.newlinesToAppend,f=c.newlinesToPrepend;s=(o+=u.length)+l.length,l=u+l+f}return{text:l,selectionStart:o,selectionEnd:s}}(t,e):E(t,e),function(t,e){var n=e.text,i=e.selectionStart,r=e.selectionEnd,l=t.selectionStart,o=t.value.slice(0,l),s=t.value.slice(t.selectionEnd);if(null===v||!0===v){t.contentEditable="true";try{v=document.execCommand("insertText",!1,n)}catch(t){v=!1}t.contentEditable="false"}if(v&&!t.value.slice(0,t.selectionStart).endsWith(n)&&(v=!1),!v){try{document.execCommand("ms-beginUndoUnit")}catch(t){}t.value=o+n+s;try{document.execCommand("ms-endUndoUnit")}catch(t){}var a=document.createEvent("Event");a.initEvent("input",!0,!0),t.dispatchEvent(a)}null!=i&&null!=r?t.setSelectionRange(i,r):t.setSelectionRange(l,t.selectionEnd)}(t,n)},k=navigator.userAgent.match(/Macintosh/)?"⌘":"ctrl",w=function(t){function e(){return t.apply(this,arguments)||this}a(e,t);var n=e.prototype;return n.config=function(t){t||this.$().tooltip()},n.view=function(){return m("button",{className:"Button Button--icon Button--link",title:this.title(),"data-hotkey":this.props.hotkey,onclick:this.click.bind(this),onkeydown:this.keydown.bind(this)},p()(this.props.icon))},n.keydown=function(t){" "!==t.key&&"Enter"!==t.key||(t.preventDefault(),this.click())},n.click=function(){return t=this.element,e=this.props.style,n=t.parentElement,i=g({},{prefix:"",suffix:"",blockPrefix:"",blockSuffix:"",multiline:!1,replaceNext:"",prefixSpace:!1,scanFor:"",surroundWithNewlines:!1,orderedList:!1,trimFirst:!1},e),void((r=document.getElementById(n.dataset.for))&&(r.focus(),S(r,i)));var t,e,n,i,r},n.title=function(){var t=this.props.title;return this.props.hotkey&&(t+=" <"+k+"-"+this.props.hotkey+">"),t},e}(u.a);
/*!
 * Includes modified code from GitHub Markdown Toolbar Element
 * https://github.com/github/markdown-toolbar-element/
 *
 * Original Copyright GitHub, Inc.
 * Released under the MIT license
 * https://github.com/github/markdown-toolbar-element/blob/master/LICENSE
 */
app.initializers.add("flarum-markdown",function(t){var e=1;Object(i.extend)(l.a.prototype,"init",function(){this.textareaId="textarea"+e++}),Object(i.extend)(l.a.prototype,"view",function(t){t.children[0].attrs.id=this.textareaId}),Object(i.extend)(l.a.prototype,"configTextarea",function(t,e,n,i){if(!n){var r=new s.a(e);r.disableInline(),r.ignoreTab(),i.onunload=function(){r.destroy()}}}),Object(i.extend)(l.a.prototype,"toolbarItems",function(e){var n=function(e){return t.translator.trans("flarum-markdown.forum.composer."+e+"_tooltip")};e.add("markdown",m(h,{for:this.textareaId},m(w,{title:n("header"),icon:"fas fa-heading",style:{prefix:"### "}}),m(w,{title:n("bold"),icon:"fas fa-bold",style:{prefix:"**",suffix:"**",trimFirst:!0},hotkey:"b"}),m(w,{title:n("italic"),icon:"fas fa-italic",style:{prefix:"_",suffix:"_",trimFirst:!0},hotkey:"i"}),m(w,{title:n("quote"),icon:"fas fa-quote-left",style:{prefix:"> ",multiline:!0,surroundWithNewlines:!0}}),m(w,{title:n("code"),icon:"fas fa-code",style:{prefix:"`",suffix:"`",blockPrefix:"```",blockSuffix:"```"}}),m(w,{title:n("link"),icon:"fas fa-link",style:{prefix:"[",suffix:"](url)",replaceNext:"url",scanFor:"https?://"}}),m(w,{title:n("image"),icon:"fas fa-image",style:{prefix:"![",suffix:"](src)",replaceNext:"src",scanFor:"https?://"}}),m(w,{title:n("unordered_list"),icon:"fas fa-list-ul",style:{prefix:"- ",multiline:!0,surroundWithNewlines:!0}}),m(w,{title:n("ordered_list"),icon:"fas fa-list-ol",style:{prefix:"1. ",multiline:!0,orderedList:!0}})),100)})})}]);
//# sourceMappingURL=forum.js.map